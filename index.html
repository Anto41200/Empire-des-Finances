<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Empire des Finances</title>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
<link rel="stylesheet" href="style.css">
<script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-auth-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-database-compat.js"></script>
</head>
<body>

<header>
  Empire des Finances
</header>

<nav class="controls">
  <button class="btn" onclick="showPage('home')">Accueil</button>
  <button class="btn" onclick="showPage('entreprises')">Entreprises</button>
  <button class="btn" onclick="showPage('biens')">Biens</button>
  <button class="btn" onclick="showPage('democratie')">DÃ©mocratie</button>
  <button class="btn" id="login-btn">Connexion Google</button>
</nav>

<div id="container">

  <!-- Page Accueil -->
  <div id="home" class="page card">
    <h2>Bienvenue</h2>
    <p>Votre patrimoine : <span id="patrimoine">Â§0</span></p>
    <div class="grid" id="historique"></div>
  </div>

  <!-- Page Biens -->
  <div id="biens" class="page card hidden">
    <h2>Vos Biens</h2>
    <div class="grid" id="liste-biens"></div>
  </div>

  <!-- Page Entreprises -->
  <div id="entreprises" class="page card hidden">
    <h2>Acheter une Entreprise</h2>
    <div class="grid" id="liste-entreprises"></div>
  </div>

  <!-- Page DÃ©mocratie -->
  <div id="democratie" class="page card hidden">
    <h2>DÃ©mocratie</h2>
    <p>Page vide pour futurs contenus.</p>
  </div>

</div>

<script>
// ==========================
// Firebase config
// ==========================
const firebaseConfig = {
  apiKey: "VOTRE_API_KEY",
  authDomain: "VOTRE_DOMAINE.firebaseapp.com",
  databaseURL: "https://VOTRE_DOMAINE.firebaseio.com",
  projectId: "VOTRE_PROJECT_ID",
  storageBucket: "VOTRE_DOMAINE.appspot.com",
  messagingSenderId: "SENDER_ID",
  appId: "APP_ID"
};
firebase.initializeApp(firebaseConfig);
const auth = firebase.auth();
const db = firebase.database();

// ==========================
// Google Login
// ==========================
const loginBtn = document.getElementById('login-btn');
let currentUser = null;

loginBtn.onclick = () => {
  const provider = new firebase.auth.GoogleAuthProvider();
  auth.signInWithPopup(provider)
    .then((result) => {
      currentUser = result.user;
      loginBtn.textContent = "ConnectÃ© : " + currentUser.displayName;
      loadUserData();
    });
};

// Persistance session
auth.onAuthStateChanged(user => {
  if(user){
    currentUser = user;
    loginBtn.textContent = "ConnectÃ© : " + currentUser.displayName;
    loadUserData();
  }
});

// ==========================
// Pages navigation
// ==========================
function showPage(pageId){
  document.querySelectorAll('.page').forEach(p => p.classList.add('hidden'));
  document.getElementById(pageId).classList.remove('hidden');
}

// ==========================
// DonnÃ©es biendes et entreprises
// ==========================
const biens = [
  {name:"Maison", icon:"ðŸ ", prix:5000},
  {name:"Voiture", icon:"ðŸš—", prix:2000},
  {name:"ChÃ¢teau", icon:"ðŸ°", prix:20000}
];

const entreprises = [
  {name:"Agriculture", icon:"ðŸŒ¾", prix:10000},
  {name:"Commerce", icon:"ðŸª", prix:15000},
  {name:"Industrie", icon:"ðŸ­", prix:30000},
  {name:"Technologie", icon:"ðŸ’»", prix:50000}
];

// ==========================
// Affichage biens / entreprises
// ==========================
function displayItems(items, containerId){
  const container = document.getElementById(containerId);
  container.innerHTML = "";
  items.forEach(item => {
    const div = document.createElement('div');
    div.className = "item-card card";
    div.innerHTML = `<div class="icon">${item.icon}</div>
                     <h3>${item.name}</h3>
                     <p>Prix : Â§${item.prix}</p>
                     <button class="btn" onclick="acheter('${item.name}')">Acheter</button>`;
    container.appendChild(div);
  });
}

displayItems(biens, "liste-biens");
displayItems(entreprises, "liste-entreprises");

// ==========================
// Acheter bien / entreprise
// ==========================
function acheter(name){
  if(!currentUser){
    alert("Connectez-vous d'abord !");
    return;
  }
  alert("Vous avez achetÃ© : " + name);
  // Ici tu peux ajouter la logique pour stocker dans Firebase le bien ou entreprise
}

// ==========================
// Patrimoine historique (exemple graphique simple)
// ==========================
function loadUserData(){
  if(!currentUser) return;
  db.ref('users/'+currentUser.uid+'/patrimoine').once('value').then(snap=>{
    const val = snap.val() || 0;
    document.getElementById('patrimoine').textContent = "Â§" + val;
    displayHistorique([val]);
  });
}

function displayHistorique(data){
  const hist = document.getElementById('historique');
  hist.innerHTML = "";
  data.forEach((val,i)=>{
    const div = document.createElement('div');
    div.className = "badge";
    div.textContent = `Jour ${i+1} : Â§${val}`;
    hist.appendChild(div);
  });
}

</script>
</body>
</html>
